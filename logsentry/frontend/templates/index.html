<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LogSentry - Security Log Analyzer</title>
    
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-shield-alt"></i>
                LogSentry
                <small class="text-muted">by Anthony Frederick</small>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#upload-section">
                            <i class="fas fa-upload"></i> Upload
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#rules-section">
                            <i class="fas fa-shield-virus"></i> Rules
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#test-section">
                            <i class="fas fa-vial"></i> Test
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#about-section">
                            <i class="fas fa-info-circle"></i> About
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section bg-primary text-white py-5">
        <div class="container text-center">
            <h1 class="display-4">
                <i class="fas fa-shield-alt"></i>
                LogSentry Security Analyzer
            </h1>
            <p class="lead">
                Advanced log analysis and threat detection powered by AI
            </p>
            <p class="mb-0">
                <small>Created by Anthony Frederick, 2025</small>
            </p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid py-4">
        <!-- Status Alert -->
        <div id="status-alert" class="alert alert-info alert-dismissible fade show d-none" role="alert">
            <i class="fas fa-info-circle"></i>
            <span id="status-message"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- Upload Section -->
        <section id="upload-section" class="mb-5">
            <div class="row">
                <div class="col-lg-6">
                    <div class="card shadow">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-file-upload"></i>
                                Upload Log File
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="upload-form" enctype="multipart/form-data">
                                <div class="mb-3">
                                    <label for="logfile" class="form-label">Select Log File</label>
                                    <input type="file" class="form-control" id="logfile" name="logfile" 
                                           accept=".log,.txt,.csv,.json,.gz" required>
                                    <div class="form-text">
                                        Supported formats: .log, .txt, .csv, .json, .gz (Max: 16MB)
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="max_lines" class="form-label">Max Lines</label>
                                        <input type="number" class="form-control" id="max_lines" name="max_lines" 
                                               placeholder="All lines" min="1">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="severity_filter" class="form-label">Min Severity</label>
                                        <select class="form-select" id="severity_filter" name="severity_filter">
                                            <option value="all">All Severities</option>
                                            <option value="low">Low and above</option>
                                            <option value="medium">Medium and above</option>
                                            <option value="high">High and above</option>
                                            <option value="critical">Critical only</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="mt-3">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-search"></i>
                                        Analyze Log File
                                    </button>
                                    <button type="button" class="btn btn-secondary ms-2" id="generate-sample-btn">
                                        <i class="fas fa-magic"></i>
                                        Generate Sample
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="card shadow">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-edit"></i>
                                Analyze Text
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="text-form">
                                <div class="mb-3">
                                    <label for="log-text" class="form-label">Paste Log Data</label>
                                    <textarea class="form-control" id="log-text" rows="8" 
                                              placeholder="Paste your log entries here..."></textarea>
                                </div>
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-search"></i>
                                    Analyze Text
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Progress Bar -->
        <div id="progress-section" class="mb-4 d-none">
            <div class="card">
                <div class="card-body">
                    <h6>Analysis in Progress...</h6>
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" style="width: 100%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <section id="results-section" class="mb-5 d-none">
            <!-- Summary Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card text-center stats-card">
                        <div class="card-body">
                            <i class="fas fa-exclamation-triangle fa-2x text-warning mb-2"></i>
                            <h3 id="total-detections" class="mb-1">0</h3>
                            <p class="text-muted mb-0">Total Threats</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center stats-card">
                        <div class="card-body">
                            <i class="fas fa-tachometer-alt fa-2x text-info mb-2"></i>
                            <h3 id="risk-score" class="mb-1">0</h3>
                            <p class="text-muted mb-0">Risk Score</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center stats-card">
                        <div class="card-body">
                            <i class="fas fa-network-wired fa-2x text-primary mb-2"></i>
                            <h3 id="unique-ips" class="mb-1">0</h3>
                            <p class="text-muted mb-0">Unique IPs</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center stats-card">
                        <div class="card-body">
                            <i class="fas fa-user-secret fa-2x text-danger mb-2"></i>
                            <h3 id="suspicious-ips" class="mb-1">0</h3>
                            <p class="text-muted mb-0">Suspicious IPs</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="row mb-4">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-chart-pie"></i>
                                Threat Severity Distribution
                            </h6>
                        </div>
                        <div class="card-body">
                            <canvas id="severity-chart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-chart-bar"></i>
                                Threat Categories
                            </h6>
                        </div>
                        <div class="card-body">
                            <canvas id="category-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detections Table -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">
                        <i class="fas fa-list"></i>
                        Detected Threats
                    </h6>
                    <div>
                        <button class="btn btn-sm btn-outline-primary" id="export-json-btn">
                            <i class="fas fa-download"></i> JSON
                        </button>
                        <button class="btn btn-sm btn-outline-success" id="export-csv-btn">
                            <i class="fas fa-download"></i> CSV
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped" id="detections-table">
                            <thead>
                                <tr>
                                    <th>Line</th>
                                    <th>Rule</th>
                                    <th>Severity</th>
                                    <th>Category</th>
                                    <th>Description</th>
                                    <th>Confidence</th>
                                    <th>Matched Text</th>
                                </tr>
                            </thead>
                            <tbody id="detections-tbody">
                                <!-- Detections will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Test Rule Section -->
        <section id="test-section" class="mb-5">
            <div class="card shadow">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">
                        <i class="fas fa-vial"></i>
                        Test Rules
                    </h5>
                </div>
                <div class="card-body">
                    <form id="test-form">
                        <div class="mb-3">
                            <label for="test-text" class="form-label">Test Log Entry</label>
                            <input type="text" class="form-control" id="test-text" 
                                   placeholder="Enter a log entry to test against rules..."
                                   value="GET /admin/../../../etc/passwd HTTP/1.1">
                        </div>
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-play"></i>
                            Test Rules
                        </button>
                    </form>
                    
                    <div id="test-results" class="mt-3 d-none">
                        <h6>Test Results:</h6>
                        <div id="test-detections"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Rules Section -->
        <section id="rules-section" class="mb-5">
            <div class="card shadow">
                <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-shield-virus"></i>
                        Security Rules
                    </h5>
                    <button class="btn btn-light btn-sm" id="load-rules-btn">
                        <i class="fas fa-refresh"></i>
                        Load Rules
                    </button>
                </div>
                <div class="card-body">
                    <div id="rules-content">
                        <p class="text-muted">Click "Load Rules" to view available security detection rules.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about-section" class="mb-5">
            <div class="card shadow">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-info-circle"></i>
                        About LogSentry
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-8">
                            <h6>LogSentry CLI Security Analyzer</h6>
                            <p>
                                LogSentry is a comprehensive Python-based log analysis tool designed to detect 
                                security incidents and threats across multiple log formats. Created by Anthony Frederick 
                                in 2025, it provides advanced threat detection, IP analysis, and beautiful reporting capabilities.
                            </p>
                            
                            <h6>Key Features:</h6>
                            <ul>
                                <li>Multi-format log parsing (Apache, syslog, JSON, etc.)</li>
                                <li>20+ built-in security detection rules</li>
                                <li>IP geolocation and suspicious activity detection</li>
                                <li>Risk scoring and confidence analysis</li>
                                <li>Real-time threat detection</li>
                                <li>Export capabilities (JSON, CSV)</li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <i class="fas fa-user-circle fa-3x text-primary mb-3"></i>
                                    <h6>Creator</h6>
                                    <p class="mb-0"><strong>Anthony Frederick</strong></p>
                                    <p class="text-muted small">2025</p>
                                    
                                    <hr>
                                    
                                    <div class="row text-center">
                                        <div class="col-6">
                                            <small class="text-muted">Version</small>
                                            <div><strong>1.0.0</strong></div>
                                        </div>
                                        <div class="col-6">
                                            <small class="text-muted">License</small>
                                            <div><strong>MIT</strong></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-3">
        <div class="container text-center">
            <p class="mb-0">
                &copy; 2025 LogSentry by Anthony Frederick. All rights reserved.
                <span class="ms-3">
                    <i class="fas fa-shield-alt"></i>
                    Secure. Reliable. Efficient.
                </span>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>